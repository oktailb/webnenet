<html>

<head>
	<meta charset="UTF-8">
	<title>It thinks</title>
</head>

<body>
	<div id="neuronEditor"></div>
	<span id="neuronParameters"></span>
	<script type="text/javascript" src="ajaxlib.js"></script>
	<script type="text/javascript" src="math.js"></script>
	<script type="text/javascript" src="neuron.js"></script>
	<script type="text/javascript" src="brain.js"></script>
	<script type="text/javascript">
		function random() {
			return getRandomFloat(-10.0, 10.0);
		}

		const brain = {
			"neurons": [
				{
					"name": "n11",
					"activation": relu,
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_0", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n12",
					"activation": relu,
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_1", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n13",
					"activation": relu,
					"activationParams": [1.0, 0.5, 1.07, -0.3],
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_2", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n14",
					"activation": relu,
					"activationParams": [1.0, 0.5, 1.07, -0.3],
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_3", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n15",
					"activation": relu,
					"activationParams": [1.0, 0.5, 1.07, -0.3],
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_4", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n16",
					"activation": relu,
					"activationParams": [1.0, 0.5, 1.07, -0.3],
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_5", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n17",
					"activation": relu,
					"activationParams": [1.0, 0.5, 1.07, -0.3],
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_6", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n18",
					"activation": relu,
					"activationParams": [1.0, 0.5, 1.07, -0.3],
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_7", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n19",
					"activation": relu,
					"activationParams": [1.0, 0.5, 1.07, -0.3],
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_8", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n110",
					"activation": relu,
					"activationParams": [1.0, 0.5, 1.07, -0.3],
					"bias": 0.5,
					"inputs": [
						{ "value": "img_0_9", "factor": 0.42 },
						{ "value": random, "factor": 0.05 }
					]
				},
				{
					"name": "n21",
					"activation": sep,
					"activationParams": [1.0, 1.0, 1.0, 1.0],
					"bias": 0.42,
					"inputs": [
						{ "value": "n11", "factor": 0.5 },
						{ "value": "n12", "factor": 1.0 },
						{ "value": "n13", "factor": 0.42 },
						{ "value": "n14", "factor": 0.42 },
						{ "value": "n15", "factor": 0.42 },
						{ "value": "n16", "factor": 0.42 },
						{ "value": "n17", "factor": 0.42 },
						{ "value": "n18", "factor": 0.42 },
						{ "value": "n19", "factor": 0.42 }
					]
				},
				{
					"name": "n22",
					"activation": tanh,
					"activationParams": [1.0, 1.0, 1.0, 1.0],
					"bias": 0.42,
					"inputs": [
						{ "value": "n11", "factor": 0.5 },
						{ "value": "n12", "factor": 1.0 },
						{ "value": "n13", "factor": 0.42 },
						{ "value": "n14", "factor": 0.42 },
						{ "value": "n15", "factor": 0.42 },
						{ "value": "n16", "factor": 0.42 },
						{ "value": "n17", "factor": 0.42 },
						{ "value": "n18", "factor": 0.42 },
						{ "value": "n19", "factor": 0.42 }
					]
				},
				{
					"name": "OUTPUT",
					"activation": sigmoid,
					"activationParams": [1.0, 1.0, 1.0, 1.0],
					"bias": 0.42,
					"inputs": [
						{ "value": "n21", "factor": -0.5 },
						{ "value": "n22", "factor": 1.2 },
					]
				}
			],
			"inputs": [
				{
					"name": "picture",
					"type": "img",
					"data": "test.png",
					"neuronprefix": "img",
					"activation": sigmoid,
					"activationParams": [1.0, 1.0, 1.0, 1.0],
				},
				{
					"name": "any data",
					"type": "raw",
					"data": "example.dat",
					"neuronprefix": "raw",
					"activation": sigmoid,
					"activationParams": [1.0, 1.0, 1.0, 1.0],
				},
				{
					"name": "formated columns data",
					"type": "csv",
					"data": "example.csv",
					"neuronprefix": "csv",
					"activation": sigmoid,
					"activationParams": [1.0, 1.0, 1.0, 1.0],
				},
			],
			"predictions": [
				{
					"name": "result of picture analysis",
					"results": [
						{
							"neuron": "OUTPUT1",
							"name": "devil cat"
						}
					]
				},
				{},
				{}
			]
		};

async function main()
{
		var editor = document.getElementById("neuronEditor");
		var parameters = document.getElementById("neuronParameters");

		var canvas = document.createElement("canvas");
		canvas.id = "neuronVisualisator";
		canvas.width = getWidth() * 4;
		canvas.height = 4096;
		editor.appendChild(canvas);

		var secondaryCanvas = document.createElement("canvas");
		secondaryCanvas.id = "secondaryCanvas"
		editor.appendChild(secondaryCanvas);

		var ctx = canvas.getContext("2d");

		var example = await initBrain(brain);
		await example.sleep(1000);
		example.compute();
		example.draw(canvas);
}

main();
	</script>
</body>

</html>